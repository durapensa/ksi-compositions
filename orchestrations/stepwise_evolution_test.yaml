name: stepwise_evolution_test
type: orchestration
version: 1.0.0
description: |
  Evolution test using step-wise execution model.
  Each step emits events and requests continuation.
author: stepwise_system

agents:
  stepwise_evolver:
    profile: "base_orchestrator"
    vars:
      pattern_name: "stepwise_evolution_test"
      initial_prompt: |
        You are a step-wise evolution orchestrator. Your agent_id is: {{agent_id}}
        
        Configuration:
        - Total steps: {{num_steps}}
        - Decision interval: {{decision_interval}}
        
        CRITICAL: Execute ONE STEP at a time:
        
        STEP 1: If this is your first message, initialize:
        {"event": "orchestration:track", "data": {"type": "init", "step": 1, "status": "starting"}}
        {"event": "agent:needs_continuation", "data": {"reason": "Initialize performance baseline"}}
        
        STEP 2-N: On each continuation:
        1. Query your previous state: {"event": "orchestration:query", "data": {"type": "state"}}
        2. Determine current step number from state
        3. Execute ONE of:
           - Measure performance for this step
           - Make a decision (every {{decision_interval}} steps)
           - Discover improvement (at step 8)
        4. Emit appropriate events for that step
        5. If more steps remain: {"event": "agent:needs_continuation", "data": {"reason": "Step X complete, proceed to X+1"}}
        6. If all steps done: {"event": "orchestration:request_termination", "data": {"agent_id": "{{agent_id}}", "reason": "All steps complete"}}
        
        Example for step 3:
        {"event": "orchestration:track", "data": {"type": "performance", "step": 3, "metrics": {"throughput": 12.5, "error_rate": 0.02}}}
        {"event": "composition:track_decision", "data": {"pattern": "stepwise_evolution_test", "decision": "maintain_course", "confidence": 0.4}}
        {"event": "agent:needs_continuation", "data": {"reason": "Step 3 complete, proceed to step 4"}}

metadata:
  tags:
    - stepwise
    - evolution
    - incremental
  capabilities_required:
    - orchestration:track
    - orchestration:query
    - composition:track_decision

orchestration_logic:
  description: |
    Step-wise execution pattern for incremental orchestration.
  
  strategy: |
    INITIALIZE:
      Track init state
      Request continuation
    
    FOR each step:
      Query previous state
      Execute step action
      Track step results
      Request continuation
    
    TERMINATE when all steps complete

variables:
  num_steps: 10
  decision_interval: 3