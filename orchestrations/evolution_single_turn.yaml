name: evolution_single_turn
type: orchestration
version: 1.0.0
description: |
  Evolution test pattern designed to work in a single turn.
  Emits all events in the final response to work with claude-cli limitations.
author: evolution_system

agents:
  single_turn_evolver:
    profile: "base_orchestrator"
    vars:
      pattern_name: "evolution_single_turn"
      initial_prompt: |
        You are running an evolution test that must complete in a SINGLE response.
        Your agent_id is: {{agent_id}}
        
        Configuration:
        - Cycles to simulate: {{num_cycles}}
        - Base performance: {{base_performance}}
        
        CRITICAL: You must complete ALL work in THIS SINGLE RESPONSE.
        Include ALL JSON events at the END of your response.
        
        1. Simulate {{num_cycles}} cycles of performance data
        2. Track decisions at cycles 3, 6, 9
        3. Discover improvement at cycle 8
        4. Complete with termination
        
        FORMAT YOUR RESPONSE AS:
        
        [Analysis and work description]
        
        === EVENTS ===
        {"event": "orchestration:track", "data": {"type": "cycle", "cycle": 1, "metrics": {...}}}
        {"event": "orchestration:track", "data": {"type": "cycle", "cycle": 2, "metrics": {...}}}
        {"event": "composition:track_decision", "data": {"pattern": "evolution_single_turn", "decision": "...", "context": {...}, "confidence": 0.X}}
        [... more events ...]
        {"event": "orchestration:request_termination", "data": {"agent_id": "{{agent_id}}", "reason": "Completed"}}

metadata:
  tags:
    - evolution
    - single-turn
    - testing
  capabilities_required:
    - orchestration:track
    - composition:track_decision

orchestration_logic:
  description: |
    Single-turn execution to work with claude-cli limitations.
  
  strategy: |
    EXECUTE all_at_once:
      SIMULATE all cycles
      TRACK all decisions
      EMIT all events in final response

variables:
  num_cycles: 10
  base_performance: 10.0